
### Искусственный интеллект и его основные составляющие

На сегодняшний день нет единого определения искусственного интеллекта (artificial intelligence, AI). Термин AI перегружен и может использоваться для всего, что касается автоматизированного принятия решений на основе данных (система рекомендаций, компьютерное зрение, генерация текстов и изображений, прогнозирование продаж и прочее).

Самые распространенные подходы для решения бизнес-задач в рамках AI — это обучение с учителем (supervised learning) и генеративный AI (generative AI).  В работе над кейсом мы сфокусируемся на генеративном AI. 

Вы можете подробнее прочитать про иные подходы по ссылкам ниже:

- Обучение с учителем (supervised learning)
    - [Introduction to Machine Learning: Supervised Learning, Google for Developers](https://developers.google.com/machine-learning/intro-to-ml/supervised) 
    - [Supervised Machine Learning: Regression and Classification](https://www.coursera.org/learn/machine-learning) Coursera,
    - [Stanford CS229: Machine Learning Full Course taught by Andrew Ng](https://www.youtube.com/playlist?list=PLoROMvodv4rMiGQp3WXShtMGgzqpfVfbU)
- Обучение без учителя (unsupervised learning)
    - [What is unsupervised learning?, Google Cloud newsletter](https://cloud.google.com/discover/what-is-unsupervised-learning#:~:text=Unsupervised%20learning%20in%20artificial%20intelligence,any%20explicit%20guidance%20or%20instruction.)
    - [Unsupervised Learning, Recommenders, Reinforcement Learning Coursera](https://www.coursera.org/learn/unsupervised-learning-recommenders-reinforcement-learning)  
         
- Обучение с подкреплением (reinforcement learning)
    - [Reinforcement learning By Cameron Hashemi-Pour, Joseph M. Carew](https://www.techtarget.com/searchenterpriseai/definition/reinforcement-learning#:~:text=Reinforcement%20learning%20is%20a%20machine,learn%20through%20trial%20and%20error.)
    - [Unsupervised Learning, Recommenders, Reinforcement Learning Coursera](https://www.coursera.org/learn/unsupervised-learning-recommenders-reinforcement-learning)

Подробнее про генеративный AI — в курсе [Generative AI for Everyone, Andrew Ng](https://www.coursera.org/learn/generative-ai-for-everyone?utm_medium=sem&utm_source=gg&utm_campaign=B2C_EMEA_generative-ai-for-everyone_deeplearning-ai_FTCOF_learn_country-multi&campaignid=20801851121&adgroupid=158970719914&device=c&keyword=coursera%20ai%20for%20everyone&matchtype=b&network=g&devicemodel=&adposition=&creativeid=682104215164&hide_mobile_promo&gclid=CjwKCAiAg9urBhB_EiwAgw88mdJiXja1n_UtQ3VsQ_p-pFOJ0EWxqzh713hZH7u7QM0e_nM4Qgxo0hoCm_MQAvD_BwE).



| Что может делать LLM  | Где это может быть полезно                                                                                                                             |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Саммаризация текстов  | Автоматическое формирование краткого описания для документов или наборов документов, например, договоров, инструкций, финансовых документов.           |
| Ответы на вопросы     | Автоматические ответы на часто задаваемые вопросы.                                                                                                     |
| Классификация текстов | Определение тематики текстов, тональности текстов.                                                                                                     |
| Экстракция информации | Извлечение конкретных полей из документов, например извлечение контрагентов и условий контракта, сумм из инвойсов, контактной информации из заявлений. |
| Поддержка диалога     | Например, чат-боты для службы поддержки, онбординга новых сотрудников, проведения собеседований, заказа товаров.                                       |
| Перевод               | Автоматический перевод статей, описаний товаров и услуг.                                                                                               |

Для пользователя же это выглядит как ответ, который имеет смысл. В реальности большая языковая модель не решает задачу «понимания текста», она просто генерирует одно следующее слово.

Удивительное свойство LLM в том, что через решение задачи генерации следующего слова модель восстанавливает очень сложную структуру языка. Из-за этого у человека, который использует модель, может создаваться ощущение «понимания» моделью текста.

Мы рассмотрели очень упрощенное описание логики работы LLM. Подробнее про принципы работы больших языковых моделей читайте здесь:

- «[Большие языковые модели: основы для тех, кто хочет строить продукты на их базе](https://gopractice.ru/product/large-language-models/)», GoPractice
- Курс Andrew Ng “[Generative AI for Everyone](https://www.deeplearning.ai/courses/generative-ai-for-everyone/)”
- Andrej Karpathy “[Intro to Large Language Models](https://www.youtube.com/watch?v=zjkBMFhNj_g)”
- Stephen Wolfram “[What Is ChatGPT Doing … and Why Does It Work?](https://writings.stephenwolfram.com/2023/02/what-is-chatgpt-doing-and-why-does-it-work/)”, перевод данной статьи на русский язык – «[Что делает ChatGPT… и почему это работает?](https://habr.com/ru/articles/739014/)»
- [Generative AI exists because of the transformer](https://ig.ft.com/generative-ai/)
- [Визуализатор работы LLM](https://bbycroft.net/llm) от Brendan Bycroft


> Если вы хотите понять, рационально ли использовать большую языковую модель для определенной задачи, ответьте на вопрос: 
> «Может ли стажер, который недавно закончил университет, выполнить задачу на основе подробной инструкции?».


### Промпт — основной инструмент управления LLM 
**Промпт** (prompt, подсказка, затравка) — это текст, который изначально подается на вход большой языковой модели.

### Алгоритм промпт-инжиниринга 

Ниже приведен алгоритм промпт-инжиниринга для решения прикладных задач с помощью LLM:

- Шаг 1: Сформулируйте простой стартовый промпт.
- Шаг 2: Возьмите примеры данных и вычислите для них результаты.
- Шаг 3: Сделайте анализ ошибок.
- Шаг 4: Улучшите промпт на основе анализа ошибок и вернитесь к шагу 2.

В таком цикле стоит подбирать промпт до тех пор, пока он не станет давать ответ необходимого качества.

### Базовые рекомендации для подбора и улучшения промптов

Подбор промптов — это итеративная и творческая работа. 

Давайте рассмотрим базовые рекомендации для создания промптов:

- **Используйте четкие и подробные инструкции**
    - Указывайте, в какой роли выступает модель, когда она должна формировать ответ. Например, вы можете поручить ей выступать в роли продакт-менеджера или аналитика, который проводит исследование и анализирует фидбек пользователей.
    - Используйте разделители смысловых блоков, такие как “”, === , < >, <tag> </tag>. При этом формальных рекомендаций того, в каких случаях какие разделители использовать, нет; главное, чтобы разные смысловые блоки были явным образом разделены.
    - Задавайте формат ответа: JSON, HTML, таблица или другой.
    - Давайте примеры правильных и неправильных ответов для решаемой задачи (это называется few-shot learning).
    - Просите модель перепроверять, удовлетворяются ли все необходимые условия.
- **Дайте модели «время подумать»**
    - Перечисляйте инструкции для исполнения задачи как четкую последовательность шагов. Пример: Шаг 1: сделай X , Шаг 2: сделай Y , …., Шаг N: сделай Q. 
    - Добавляйте в промпт инструкцию «Решай задачу шаг за шагом» ('Solve the problem step by step').
    - Просите модель дать объяснение для ее ответов. Это поможет с идеями для улучшений в следующей итерации.

Полезность рекомендаций следует проверять для каждой конкретной задачи; универсальных правил нет.

Подробнее про подбор промптов: 

- [ChatGPT Prompt Engineering for Developers](https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/)
- [Prompt Engineering Guide](https://www.promptingguide.ai/)
- [OpenAI Prompt Engineering Guide](https://platform.openai.com/docs/guides/prompt-engineering)

**Задачи генеративного AI** — создавать новый высококачественный контент (текст, изображения, звук, видео) на основе запроса к модели. Модели генеративного AI обучаются на огромных объемах сырых данных: текстов, изображений, звука, видео.

Модели для генерации текстов с помощью AI называют **большими языковыми моделями** (large language models, LLMs). Такие модели обучаются на огромных объемах текстовых данных и обычно содержат миллиарды параметров.

Принцип работы больших языковых моделей для генерации текстов:

- Модель получает на вход строку текста.
- Задача модели — подобрать наиболее подходящее следующее слово.
- После этого обновленная строка текста вновь подается на вход модели и она вновь подбирает наиболее подходящее следующее слово.
- И так далее.

Главный элемент управления LLM — это **промпт**, то есть текст, который подается на вход модели. Оптимизируя промпт, можно улучшать результат работы модели. 

Алгоритм подбора промптов для решения прикладных задач с помощью LLM: 

- Шаг 1: Сформулируйте стартовый промпт.
- Шаг 2: Возьмите примеры данных и вычислите для них результаты. 
- Шаг 3: Сделайте анализ ошибок.
- Шаг 4: Улучшите промпт на основе анализа ошибок и вернитесь к шагу 2.

В таком цикле стоит подбирать промпт до тех пор, пока он не станет давать ответ необходимого качества. 

Теперь у вас есть фундамент знаний, необходимых для решения прикладной задачи с помощью генеративного AI. В следующей главе мы перейдем непосредственно к работе над кейсом для анализа отзывов пользователей. 

### Даже если вы все забудете, помните это

Чем лучше подобран промпт под задачу, тем лучше будет результат.