Важнейшие аспекты в работе над AI-проектами — это решения:
- Как именно внедрять AI-систему. 
- Как добиться того, чтобы она создавала максимум ценности для пользователей и бизнеса.


Для создания полноценного самостоятельного сервиса на основе реализованного AI-пайплайна потребуется реализовать много дополнительных частей: мониторинг качества данных и работы моделей, интеграцию с источниками отзывов и IT-системами компании, модули визуализации данных и так далее.

Набор технологических частей, необходимых для предсказуемой работы AI-пайплайна, мы будем называть AI-системой.

![[Pasted image 20240703143520.png]]

### Мониторинг качества данных и ответов моделей

В продакшене могут возникать самые разные ошибки, которые будут искажать результаты работы системы. Для того чтобы оперативно обнаруживать проблемы с данными, существуют инструменты мониторинга качества данных, например [EvidentlyAI](https://www.evidentlyai.com/).

Мы также рекомендуем настраивать мониторинг качества ответов моделей. Резкие скачки качества могут являться сигналом сбоев в работе системы.

Подробнее об анализе качества больших языковых моделей: [Evaluate, test, and monitor NLP and LLM-powered systems](https://www.evidentlyai.com/product/nlp-llm-monitoring) от [EvidentlyAI](https://www.evidentlyai.com/).

### Регулярный скрининг изменений

На рынке постоянно появляются новые модели, обновляются старые, меняются условия работы с ними (стоимость, API, регуляции).

Очень важно внимательно отслеживать изменения в используемых моделях, а также регулярно проводить эксперименты с новыми моделями и внедрять их, если это позволяет повысить ценность для бизнеса (улучшить качество, снизить издержки). 

При экспериментах с новыми моделями держите в уме следующие детали: 

- При изменении модели надо всегда заново оценивать качество.
- Для новых моделей может потребоваться заново подбирать промпты.
- Новые модели могут существенно увеличить затраты на их использование, а могут и сократить, поэтому надо аккуратно оценивать, оправданы ли издержки на новую модель с точки зрения экономики проекта или нет.

### Как оценить стоимость использования моделей

Стоимость использования платных больших языковых моделей формируется из стоимости обработки входного текста (промпта) и генерации ответа модели.

Стоимость вычисляется на уровне количества токенов в промпте и ответе модели. 

Токен — это слово или часть слова. Например, слово “idea” состоит из одного токена (“idea”), а слово “economy” — из двух (“e” и “conomy”). 

Знать детали работы токенизации на практике не надо. Можно запомнить, что количество токенов в тексте обычно примерно на 33% больше, чем количество слов в тексте (для английского языка). Для точной оценки количества токенов для GPT моделей можно использовать [Tokenizer](https://platform.openai.com/tokenizer) или библиотеку [tiktoken](https://github.com/openai/tiktoken).

Вы можете ознакомиться со стоимостью использования GPT-моделей на [сайте OpenAI](https://openai.com/pricing). Обратите внимание, что стоимость обработки входных и выходных токенов указывается отдельно.


Полезные источники:
- Обзор наиболее важных LLM: [Best Large Language Models for 2024 and How to Choose the Right One for Your Site](https://www.hostinger.com/tutorials/large-language-models).
- Обзор лидеров среди открытых LLM: [LLM Leaderboard best models](https://huggingface.co/collections/open-llm-leaderboard/llm-leaderboard-best-models-652d6c7965a4619fb5c27a03).
- Сервис для сравнения моделей: [Artificial Analysis](https://artificialanalysis.ai/).

### Общий подход к задачам на базе LLM

Реализованный в кейсе алгоритм можно обобщить для многих задач, которые решаются с помощью больших языковых моделей:

- Понять постановку задачи и сформировать пайплайн для ее решения.
- Для каждого элемента пайплайна необходимо
    - определить метрики качества;
    - найти или сформировать нужные данные;
    - подобрать промпты на основе итеративного улучшения и анализа ошибок, чтобы добиться хорошего качества решения.
- Научиться превращать результаты работы пайплайна в полезный инструмент.

Эти шаги мы проделали для анализа отзывов. Подходы к другим задачам с большими языковыми моделями будут очень похожими.


Давайте еще раз вспомним основные аспекты работы с генеративным AI, которые мы изучили.

**Задача генеративного AI** — создавать новый высококачественный контент (текст / изображения / звук / видео) на основе запроса к модели. Модели генеративного AI обучаются на огромных объемах сырых данных: текстов, изображений, звука, видео.

#### Принцип работы больших языковых моделей для генерации текста

- Модель получает на вход строку текста.
- Задача модели — подобрать наиболее подходящее следующее слово.
- После этого обновленная строка текста вновь подается на вход модели и она вновь подбирает наиболее подходящее следующее слово.
- И так далее.

#### Алгоритм подбора промптов для решения прикладных задач с помощью LLM 

- Шаг 1: Сформулируйте стартовый промпт.
- Шаг 2: Возьмите несколько примеров данных и вычислите для них результаты. 
- Шаг 3: Сделайте анализ ошибок.
- Шаг 4: Улучшите промпт на основе анализа ошибок и вернитесь к шагу 2.

В таком цикле стоит подбирать промпт до тех пор, пока он не станет давать необходимое качество.

#### Базовые рекомендации для подбора промптов

- **Используйте четкие и подробные инструкции**
    - Указывайте, в какой роли выступает модель, когда она должна формировать ответ. Например, вы можете поручить ей выступать в роли продакт-менеджера или аналитика, который проводит исследование и анализирует фидбек пользователей.
    - Используйте разделители смысловых блоков, такие как “”, ===, < >, <tag> </tag>. При этом формальных рекомендаций того, в каких случаях какие разделители использовать, нет; главное, чтобы разные смысловые блоки были явным образом разделены.
    - Задавайте формат ответа: JSON, HTML, таблица или другой.
    - Давайте примеры правильных и неправильных ответов для решаемой задачи (это называется few-shot learning).
    - Просите модель перепроверять, удовлетворяются ли все необходимые условия.
- **Дайте модели «время подумать»**
    - Перечисляйте инструкции для исполнения задачи как четкую последовательность шагов. Пример: Шаг 1: сделай X , Шаг 2: сделай Y , …., Шаг N: сделай Q. 
    - Добавляйте в промпт инструкцию «Решай задачу шаг за шагом» ('Solve the problem step by step').
    - Просите модель дать объяснение для ее ответов. Это поможет с идеями для улучшений в следующей итерации.

Полезность рекомендаций следует проверять для каждой конкретной задачи; универсальных правил нет.

#### Всегда оценивайте качество промптов

Типовой подход для оценки — использовать обучающий и тестовый датасеты:

- на обучающем датасете нужно подбирать промпты;
- на тестовом датасете — проводить финальную оценку качества. 

Важная зона ответственности AI-продакта — решать, где необходимо действовать на основе измерения бизнес-метрик, а где достаточно субъективных решений на основе измерения метрик качества.

#### Общий подход к решению задач с большими языковыми моделями

- Понять постановку задачи и пайплайн.
- Для каждого элемента пайплайна необходимо
    - определить метрики качества;
    - найти или сформировать нужные данные;
    - подобрать промпты на основе итеративного улучшения и анализа ошибок, чтобы добиться хорошего качества решения.
- Научиться превращать результаты работы пайплайна в полезный инструмент.

#### AI-системы

Создание AI-пайплайна для решения вашей задачи — это лишь первый шаг на пути к созданию продакшн-решения. Полноценная AI-система содержит много технологических частей, необходимых для ее предсказуемой и надежной работы.

Аспекты, которые важно предусмотреть при внедрении AI-систем:

- Мониторинг качества данных и ответов моделей.
- Регулярный скрининг изменений облачных сервисов.

![](https://gopractice.ru/s3/public.gopractice.ru/course/8ba06efa-f267-4003-b112-f4d003ecfa26.png)

Вопросы оценки и менеджмента стоимости решений на основе GenAI — это область ответственности AI-продакта, а именно:

- оценка стоимости использования моделей;
- выбор модели для вашего проекта;
- оценка перспективности внедрения решения.

В кейсе мы показали, как за короткое время реализовать AI-пайплайн обработки отзывов, обладающий качеством на уровне лидирующих решений в индустрии. В прошлом для создания такого продукта потребовалась бы дорогая команда ML-инженеров. Современные технологии позволяют построить ядро такого сервиса силами одного человека за несколько часов.

### Даже если вы все забудете, помните это

Ранее для решения AI-задач требовались AI-специалисты с глубокими знаниями технологий машинного обучения, математики и программирования. 

Современные инструменты генеративного AI позволяют решать многие задачи без такой команды. Но для этого все равно необходимо освоить фундаментальные подходы к созданию AI-продуктов, а также учитывать специфику бизнес-задач.

Вы можете получить эти знания и навыки в нашем [«Симуляторе управления AI/ML-проектами»](https://gopractice.ru/course/ml/).